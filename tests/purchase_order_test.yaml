name: purchase_order
tests:
  - name: regional_apac_thingamabobs_purchase_order
    input:
      resource: regional_apac_thingamabobs_purchase_order
      actions:
        - prepareForDelivery
        - sendInvoice
        - view

    expected:
      - principal: regional_apac_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: regional_emea_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_global_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: regional_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: super_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: thingamabob_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_customer_and_widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

  - name: regional_emea_widgets_purchase_order
    input:
      resource: regional_emea_widgets_purchase_order
      actions:
        - prepareForDelivery
        - sendInvoice
        - view

    expected:
      - principal: regional_apac_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_emea_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: regional_global_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: regional_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: super_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: thingamabob_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_customer_and_widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

  - name: vanilla_doohickeys_purchase_order
    input:
      resource: vanilla_doohickeys_purchase_order
      actions:
        - prepareForDelivery
        - sendInvoice
        - view

    expected:
      - principal: regional_apac_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_emea_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_global_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: super_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: thingamabob_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_customer_and_widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

  - name: vanilla_thingamabobs_purchase_order
    input:
      resource: vanilla_thingamabobs_purchase_order
      actions:
        - prepareForDelivery
        - sendInvoice
        - view

    expected:
      - principal: regional_apac_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_emea_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_global_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: super_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: thingamabob_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_customer_and_widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

  - name: vanilla_widgets_purchase_order
    input:
      resource: vanilla_widgets_purchase_order
      actions:
        - prepareForDelivery
        - sendInvoice
        - view

    expected:
      - principal: regional_apac_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_emea_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_global_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: regional_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: super_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: thingamabob_manufacturer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_DENY

      - principal: vanilla_customer
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_customer_and_widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW

      - principal: vanilla_operations
        actions:
          prepareForDelivery: EFFECT_DENY
          sendInvoice: EFFECT_ALLOW
          view: EFFECT_ALLOW

      - principal: widget_manufacturer
        actions:
          prepareForDelivery: EFFECT_ALLOW
          sendInvoice: EFFECT_DENY
          view: EFFECT_ALLOW
